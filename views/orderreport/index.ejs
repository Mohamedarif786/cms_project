<!DOCTYPE html>
<html lang="en">

<head>
	<title>
		<%= pageTitle %>
	</title>
	<%- include("../partials/head") %>
</head>
<!--
  HOW TO USE: 
  data-theme: default (default), dark, light
  data-layout: fluid (default), boxed
  data-sidebar-position: left (default), right
  data-sidebar-behavior: sticky (default), fixed, compact
-->

<style>
	#table_view_div th,
	#table_view_div td {
		white-space: nowrap;
	}

	.handsontable .errorClass {
		background: pink
	}

	@media (min-width: 576px) {
		.modal-dialog-new {
			max-width: 95% !important;
		}
	}
</style>

<body data-theme="default" data-layout="fluid" data-sidebar-position="left" data-sidebar-behavior="sticky">
	<div class="wrapper">
		<%- include("../partials/sidebar", {collapsed: 'false' }); %>

			<div class="main">
				<%- include("../partials/header") %>

					<main class="content p-3">

						<div class="container-fluid ">
							<div class="row">
								<div class="col-12">
									<div class="card">
										<div class="card-header">
											<div class="row">
												<div class="card-actions ">
													<button id="advanceSearch" class="btn btn-secondary">Filter</button>

													<button id="clearFilter" class="btn btn-outline-success"
														style="display:none" title="Clear Filter">
														Clear
													</button>



													<button id="import-supplier" data-name="Import Supplier Commission"
														class="import-excel btn btn-outline-primary"><i
															class="align-middle me-2" data-feather="excel"></i>Import
														Supplier Commission</button>
													<button id="import-supplier-Commission"
														data-name="Import Supplier Payment"
														class="import-excel btn btn-outline-primary"><i
															class="align-middle me-2" data-feather="excel"></i>Import
														Supplier Payment</button>
													<button id="import-client-payment" data-name="Import Client Payment"
														class="import-excel btn btn-outline-primary"><i
															class="align-middle me-2" data-feather="excel"></i>Import
														Client Payment</button>
													<button id="import-client-payout" data-name="Import Client Payout"
														class="import-excel btn btn-outline-primary"><i
															class="align-middle me-2" data-feather="excel"></i>Import
														Client Payout</button>

												</div>

											</div>
										</div>
										<div class="card-body" id="advanceContent" style="display: none;">
											<div class="row col-md-12">

												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Order Id</label>
														<input class="form-control" />
													</div>
												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Confirmation</label>
														<input class="form-control" />
													</div>
												</div>
												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Passenger Name</label>
														<input class="form-control" />
													</div>

												</div>
												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Email Address</label>
														<input class="form-control" />
													</div>

												</div>
											</div>

											<div class="row col-md-12">

												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Order Date</label>
														<input class="form-control datetimes" />
													</div>
												</div>
												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Travel Date</label>
														<input class="form-control datetimes" />
													</div>
												</div>
												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Client Pmt Date</label>
														<input class="form-control datetimes" />
													</div>

												</div>
											</div>

											<div class="row col-md-12">

												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Refund Date</label>
														<input class="form-control datetimes" />
													</div>

												</div>
												<div class="col-md-4">
													<div class="mb-3">
														<label class="form-label">Amend Date</label>
														<input class="form-control datetimes" />
													</div>

												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Booking Confirmed</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Yes">Yes</option>
															<option value="No">No</option>
														</select>

													</div>

												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Report Output</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Key Detail">Key Detail</option>
															<option value="Full Detail">Full Detail</option>
														</select>
													</div>
												</div>
											</div>

											<div class="row col-md-12">
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Client Name</label>
														<input class="form-control" />
													</div>
												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Merch of Record</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Yes">Yes</option>
															<option value="No">No</option>
														</select>
													</div>
												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Supplier Name</label>
														<select class="form-control">
															<option value="All">--All--</option>
														</select>
													</div>

												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Invoice Type</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Sale">Sale</option>
															<option value="Failed">Failed</option>
															<option value="Test">Test</option>
														</select>
													</div>

												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Booking Status</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Sale (Previously Active)">Sale
																(Previously
																Active)</option>
															<option value="Failed">Failed</option>
															<option value="Test">Test</option>
															<option value="Refunded">Refunded</option>
															<option value="Amended">Amended</option>
														</select>
													</div>

												</div>
												<div class="col-md-2">
													<div class="mb-3">
														<label class="form-label">Travel Type</label>
														<select class="form-control">
															<option value="All">--All--</option>
															<option value="Flight">Flight</option>
															<option value="Hotel">Hotel</option>
															<option value="Car">Car</option>
															<option value="Activity">Activity</option>
															<option value="Insurance">Insurance</option>
															<option value="Getaway Trip">Getaway Trip</option>
															<option value="Getaway Cruise">Getaway Cruise</option>
															<option value="Group Trip">Group Trip</option>
															<option value="Group Cruise">Group Cruise</option>
															<option value="Vacation Rental">Vacation Rental</option>
														</select>

													</div>

												</div>
											</div>

											<div class="row col-md-12">
												<div class="col-md-2">
													<button class="btn btn-primary btn-lg"
														style="height: 100%;width:100%">SUBMIT
													</button>
												</div>
												<div class="col-md-2">
													<div class="mb-3">
														&nbsp;
													</div>
												</div>
												<div class="col-md-2">
													<button class="btn btn-primary btn-lg" style="width: 100%;">Import
														Supplier <br />Commision </button>
												</div>
												<div class="col-md-2">
													<button class="btn btn-primary btn-lg" style="width: 100%;">Import
														Supplier <br />Payment </button>
												</div>
												<div class="col-md-2">
													<button class="btn btn-primary btn-lg" style="width: 100%;">Import
														Client <br />Pmt </button>
												</div>
												<div class="col-md-2">
													<button class="btn btn-primary btn-lg" style="width: 100%;">Import
														Client <br />Payout </button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<!--
							<div class="col-2" style="float: left;">
								
							</div>
							-->
							<div class="row">
								<div class="col-3" id="orderSetting" style="display: none;">
									<%- include("../partials/orderfilter", {collapsed: 'true' }); %>
								</div>
								<div class="col-9 col-12" id="orderContent">
									<div class="card">
										<div class="card-header">
											<div class="row">
												<div class="col-md-6">
													<h5 class="card-title" id="tempLoading">
														<%= title %>
													</h5>
													<h6 class="card-subtitle text-muted"></h6>
												</div>

												<div class="col-md-6 float-end" style="float: end;">
													<div class="card-actions float-end">

														<button id="export-resource" class="btn btn-secondary "><i
																class="align-middle me-2"
																data-feather="plus"></i>EXPORT</button>

														<div style="display: none;">
															<button id="add-row" class="btn btn-outline-success"><i
																	class="align-middle me-2"
																	data-feather="plus"></i>Add</button>
														</div>
														<button id="import-excel" data-name="Import"
															class="import-excel btn btn-outline-primary"><i
																class="align-middle me-2"
																data-feather="excel"></i>Import</button>

														<button id="excel-sample" class="btn btn-outline-primary"><i
																class="align-middle me-2"
																data-feather="excel"></i>Sample Download</button>

														<div style="display: none;">

															<button id="add-update" style="display:none"
																class="btn btn-outline-success"><i
																	class="align-middle me-2"
																	data-feather="plus"></i>Update</button>
														</div>
														<div style="display: none;">

															<button id="add-save" style="display:none"
																class="btn btn-outline-success"><i
																	class="align-middle me-2"
																	data-feather="plus"></i>Save</button>
														</div>
														<div style="display: none;">

															<button id="add-cancle" style="display:none"
																class="btn btn-outline-danger" title="Cancle">
																<svg xmlns="http://www.w3.org/2000/svg" width="24"
																	height="24" viewBox="0 0 24 24" fill="none"
																	stroke="currentColor" stroke-width="2"
																	stroke-linecap="round" stroke-linejoin="round"
																	class="feather feather-trash align-middle">
																	<polyline points="3 6 5 6 21 6"></polyline>
																	<path
																		d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
																	</path>
																</svg>
																Cancel
															</button>
														</div>
														<div style="display: none;">

															<button id="add-cancle-edit" style="display:none"
																class="btn btn-outline-danger" title="Cancle">
																<svg xmlns="http://www.w3.org/2000/svg" width="24"
																	height="24" viewBox="0 0 24 24" fill="none"
																	stroke="currentColor" stroke-width="2"
																	stroke-linecap="round" stroke-linejoin="round"
																	class="feather feather-trash align-middle">
																	<polyline points="3 6 5 6 21 6"></polyline>
																	<path
																		d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
																	</path>
																</svg>
																Cancel
															</button>
														</div>


													</div>
												</div>

											</div>



										</div>

										<div class="card-body">
											<div class="table-responsive col-12" id="handsontableContainer"></div>

										</div>
										<div class="card-body">
											<div class="table-responsive col-12" id="handsontableContainer-sample">
											</div>

										</div>
									</div>
								</div>
							</div>

						</div>

						<div class="modal fade" id="testMarkModal" tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Cancel Order</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<div class="modal-body">

										<form id="addForm" class="form needs-validation" autocomplete="off">
											<div class="modal-body">
												<div class="mb-3">
													<p>Are you sure you want to cancle this order ?</p>
												</div>
											</div>
										</form>

									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Close</button>
										<button type="button" class="btn btn-primary"
											id="cancel-confirm">Cancel</button>
									</div>
								</div>
							</div>
						</div>

						<div class="modal fade" id="refundMarkModal" tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Refund Order</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<div class="modal-body">

										<form id="refundForm" class="form needs-validation" autocomplete="off">
											<div class="modal-body">
												<div class="mb-3">
													<label class="form-label">Refund Amount</label>
													<input class="form-control" type="number" id="refundAmountValue"
														custom_validation="true"
														custom_validation_msg="Please enter refund amount" />
												</div>
											</div>
										</form>

									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Close</button>
										<button type="button" class="btn btn-primary"
											id="refund-confirm">Refund</button>
									</div>
								</div>
							</div>
						</div>

						<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Delete Policy</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<div class="modal-body m-3">
										<p class="mb-0">This will delete the content ?</p>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Close</button>
										<button type="button" class="btn btn-danger" id="delete-confirm">Delete</button>
									</div>
								</div>
							</div>
						</div>

						<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Edit Order</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>

									<form id="editForm" class="form needs-validation" autocomplete="off">

										<div class="modal-body" id="edidRegion">

										</div>


									</form>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Close</button>
										<button type="button" class="btn btn-primary" id="edit-confirm">Update</button>
									</div>
								</div>
							</div>
						</div>


						<div class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" id="excelImportModal"
							tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" id="modal-content" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Order Import</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<form id="importForm" class="form needs-validation" autocomplete="off">
										<div class="modal-body">
											<div class="mb-3">
												<div class="row">
													<div class="col-sm-12">
														<label class="form-label" id="import-label">Choose your Excel
															File</label>
														<input type="file" class="form-control" id="import-file"
															autocomplete="off" required custom_validation="true"
															custom_validation_msg="Please select file" />
													</div>
													<!-- <div class="col-sm-3">
														<button type="button" style="margin-top: 27px;" class="btn btn-primary"
															id="import-confirm">Import</button>
													</div> -->
												</div>
											</div>

											<div class="mb-3">
												<div class="table-responsive" id="table_view_div">

												</div>
											</div>

										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-bs-dismiss="modal">Close</button>
											<button type="button" class="btn btn-primary"
												id="import-confirm-btn">Save</button>
										</div>
									</form>
								</div>
							</div>
						</div>


					</main>
					<%- include("../partials/foot") %>
						<%- include("../partials/footer") %>
			</div>
	</div>
	<%- include("../partials/scripts") %>
		<script>
			const _apiBase = '/order-report';
			const _dataResource = [];
		</script>

		<!-- Excel read -->
		<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
		<script src="js/pagination.js"></script>
		<script src="js/orderreport.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"
			integrity="sha512-UnrKxsCMN9hFk7M56t4I4ckB4N/2HHi0w/7+B/1JsXIX3DmyBcsGpT3/BsuZMZf+6mAr0vP81syWtfynHJ69JA=="
			crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"
			integrity="sha512-csNcFYJniKjJxRWRV1R7fvnXrycHP6qDR21mgz1ZP55xY5d+aHLfo9/FcGDQLfn2IfngbAHd8LdfsagcCqgTcQ=="
			crossorigin="anonymous" type="text/javascript" referrerpolicy="no-referrer"></script>

</body>

</html>